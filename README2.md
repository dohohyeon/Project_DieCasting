실시간 품질 모니터링 대시보드

본 대시보드는 실시간으로 유입되는 제조 공정 데이터를 모니터링하고, 이상 징후 및 제품 불량을 예측하며, 머신러닝 모델의 성능과 데이터 안정성을 추적하기 위해 구축되었습니다.

주요 기능
대시보드는 크게 3개의 탭과 1개의 글로벌 기능(AI 챗봇)으로 구성되어 있습니다.

1. 탭 1: 실시간 모니터링
가장 핵심적인 모니터링 탭으로, 공정의 현재 상태를 한눈에 파악할 수 있습니다.

실시간 스트리밍 제어:

▶ 시작, ⏸ 일시정지, 🔄 리셋 버튼을 통해 데이터 스트림을 완벽하게 제어합니다.

동적 센서 시각화:

"용탕온도", "주조압력" 등 원하는 센서 변수를 체크박스로 선택하면, 해당 변수들의 실시간 추이 그래프가 즉시 생성되어 나타납니다.

즉각적인 상태 알림:

데이터가 유입될 때마다 이상치 상태 (HDBSCAN 기반)와 불량 판정 (머신러닝 모델 기반)을 양호/경고 또는 양품/불량으로 즉시 표시합니다.

공정 요약 카드:

이상치 탐지율, 불량 탐지율 (전체/오늘), 모델 예측 정확도, 일일 목표 달성률 등 핵심 KPI를 실시간으로 집계하여 보여줍니다.

모델 예측 피드백 시스템:

모델이 "불량"으로 예측한 제품의 ID와 예측 확률을 리스트업합니다.

ID 클릭 시, 상세 모달(Modal) 창이 열립니다.

현장 작업자가 실제 라벨(Ground Truth)을 확인하고 "✅ 불량 맞음" 또는 **"❌ 불량 아님"**을 선택하고, "냉각수 온도 급변"과 같은 원인에 대한 텍스트 피드백을 저장할 수 있습니다.

이 피드백은 "누적 피드백" 테이블에 기록되어 모델 개선을 위한 데이터로 활용됩니다.

2. 탭 2: P-관리도 이상 탐지
공정 전반의 안정성과 개별 변수의 이상 징후를 통계적으로 심층 분석합니다.

HDBSCAN 이상 확률 차트:

HDBSCAN 모델이 각 데이터를 얼마나 '이상치'로 의심하는지에 대한 확률(_anom_proba)을 실시간 시계열 차트로 시각화합니다.

인터랙티브 P-관리도:

전체 모니터링 변수 중 몇 %가 통계적 관리 한계(UCL/LCL)를 벗어났는지를 나타내는 P-관리도를 제공합니다.

데이터 범위와 로트 크기를 슬라이더로 조절할 수 있습니다.

▶ 재생 버튼을 통해 시간의 흐름에 따른 공정 이상 비율의 변화를 동적으로 시뮬레이션할 수 있습니다.

Nelson Rules 위반 목록:

P-관리도 차트에서 통계적으로 유의미한 이상 패턴(예: Rule 1: 3σ 초과, Rule 4: 14개 연속 교대)을 Nelson Rules에 기반하여 자동으로 탐지합니다.

위반이 감지된 시점, 위반 규칙, 당시 관리 한계를 벗어난 변수 목록을 상세히 리스트업합니다.

ARIMA 기반 개별 변수 관리도 (이상 원인 분석):

violations_list의 "이상원인 분석" 버튼과 연동됩니다.

버튼 클릭 시, 해당 시점에서 이상을 보인 첫 번째 변수가 아래의 "개별 변수 관리도"에서 자동으로 선택되며 차트 위치로 스크롤됩니다.

이 차트는 사전에 학습된 arima_stats.pkl의 통계(Auto ARIMA 기반 CL, UCL, LCL)를 바탕으로, 선택된 단일 변수의 실제 측정값이 관리 한계를 벗어나는지 정밀하게 보여주어 이상 징후의 근본 원인을 추적하게 돕습니다.

3. 탭 3: 모델 성능 평가 (MLOps)
대시보드의 예측 모델이 신뢰할 수 있는지, 데이터 분포가 변하지 않았는지 추적하는 MLOps 탭입니다.

핵심 성능 지표(KPI):

**Recall(재현율)**과 **Precision(정밀도)**을 최신 청크(Chunk) 및 전체 누적 기준으로 나누어 실시간 계산합니다.

누적 성능은 모델 개발 시 측정한 Validation 성능과 비교하여 현재 모델의 저하 여부를 판단합니다.

자동화된 MLOps 상태 알림:

모델 성능 상태: Recall 또는 Precision이 3회 연속 LCL(하한 관리선) 미만으로 떨어지면, "⚠️ 모델 성능 저하" 알림을 자동으로 표시합니다.

데이터 드리프트 상태: 특정 변수의 P-value가 3회 연속 0.05 미만으로 하락하면, "⚠️ 데이터 드리프트 의심" 알림과 함께 문제가 된 변수명을 특정하여 표시합니다.

성능 추이 차트:

Recall과 Precision이 청크 단위로 어떻게 변하는지 시계열 차트로 시각화합니다.

데이터 드리프트 시각화:

KDE Plot: 학습 데이터(Train)와 현재 실시간 데이터(최근 100개)의 분포를 KDE(커널 밀도 추정) 차트로 겹쳐 그려, 분포 변화를 직관적으로 확인합니다.

KS 검정 P-value 차트: 두 데이터 분포 간의 통계적 차이를 나타내는 P-value의 추이를 시계열로 그립니다. P-value가 유의수준(0.05) 아래로 떨어지면 데이터 드리프트가 발생했음을 의미합니다.

4. 글로벌 기능: AI 챗봇
대시보드 우측 하단의 버튼을 통해 언제든지 AI 비서를 호출할 수 있습니다.

컨텍스트 인식 (Context-Aware):

챗봇은 현재 대시보드의 모든 핵심 정보(예: "누적 재현율: 85.2%", "데이터 분포 상태: 양호")를 실시간으로 인지하고 있습니다.

자연어 질의응답:

사용자는 "지금 공정 상태 어때?", "오늘 불량률 알려줘"와 같이 자연어로 질문할 수 있습니다.

데이터 기반 답변:

"최근 50건 데이터 분석해줘"와 같은 요청이 들어오면, 챗봇은 current_data에서 최근 50건을 필터링하고 해당 데이터를 기반으로 Gemini AI 모델을 호출하여 정밀한 분석 결과를 제공합니다.

기술 스택 및 요구사항
핵심 프레임워크: Shiny for Python

데이터 처리: pandas, numpy

시각화: matplotlib, seaborn

머신러닝/통계:

scikit-learn (불량 예측 모델, 성능 지표)

hdbscan (이상치 탐지, shared.py 내 predict_anomaly에서 사용)

statsmodels / pmdarima (ARIMA 모델, arima_stats.pkl 생성에 필요)

scipy (KS 검정)

AI 챗봇: google-generativeai (Gemini)

사전 요구 파일:

shared.py: 데이터 로더, 모델 객체(defect_model, model_dict), 전역 변수 등을 포함하는 스크립트.

./data/arima_stats.pkl: train_arima_models.py (별도 스크립트, 미포함) 등을 통해 사전 생성된 ARIMA 통계 파일.

API 키: 챗봇 기능을 위해 GEMINI_API_KEY가 코드 내에 설정되어 있어야 합니다.